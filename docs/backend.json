
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user profile in the EduNex application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "name": {
          "type": "string",
          "description": "User's full name."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "mobileNumber": {
          "type": "string",
          "description": "User's mobile phone number."
        },
        "photoURL": {
          "type": "string",
          "description": "URL of the user's profile photo.",
          "format": "uri"
        },
        "registrationDate": {
          "type": "string",
          "description": "Date and time when the user registered.",
          "format": "date-time"
        },
        "govtIdType": {
          "type": "string",
          "description": "Type of government ID (e.g., Aadhar, PAN)."
        },
        "govtIdNumber": {
          "type": "string",
          "description": "The number of the government ID."
        },
        "govtIdProofUrl": {
          "type": "string",
          "description": "URL of the uploaded government ID proof document.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "registrationDate"
      ]
    },
    "Course": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Course",
      "type": "object",
      "description": "Represents a course offered on the EduNex platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the course entity."
        },
        "title": {
          "type": "string",
          "description": "Title of the course."
        },
        "classLevel": {
          "type": "string",
          "description": "The class or level the course is designed for (e.g., 10th, B.Tech)."
        },
        "subject": {
          "type": "string",
          "description": "Subject of the course (e.g., Physics, Mathematics)."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the course."
        },
        "videoLinks": {
          "type": "array",
          "description": "Links to the video lectures of the course.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "title",
        "classLevel",
        "subject",
        "description"
      ]
    },
    "Progress": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Progress",
      "type": "object",
      "description": "Represents the learning progress of a user in a specific course.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the progress record."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Progress)"
        },
        "courseId": {
          "type": "string",
          "description": "Reference to Course. (Relationship: Course 1:N Progress)"
        },
        "lastAccessed": {
          "type": "string",
          "description": "Date and time when the user last accessed the course.",
          "format": "date-time"
        },
        "completionPercentage": {
          "type": "number",
          "description": "Percentage of the course completed by the user."
        },
        "recommendedTopics": {
          "type": "array",
          "description": "AI-powered recommendations for topics the user should focus on.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "userId",
        "courseId",
        "lastAccessed",
        "completionPercentage"
      ]
    },
    "Student": {
      "title": "Student",
      "type": "object",
      "description": "SAMS student profile.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "Matches Firebase Auth UID."
        },
        "fullName": {
          "type": "string"
        },
        "course": {
          "type": "string"
        },
        "branch": {
          "type": "string"
        },
        "rollNumber": {
          "type": "string"
        },
        "email": {
          "type": "string",
          "format": "email"
        },
        "photoURL": {
          "type": "string",
          "format": "uri"
        }
      },
      "required": [
        "uid",
        "fullName",
        "course",
        "branch",
        "rollNumber",
        "email"
      ]
    },
    "Assignment": {
      "title": "Assignment",
      "type": "object",
      "description": "An assignment for a course.",
      "properties": {
        "title": {
          "type": "string"
        },
        "course": {
          "type": "string"
        },
        "dueDate": {
          "type": "string",
          "format": "date"
        },
        "fileUrl": {
          "type": "string",
          "format": "uri"
        }
      },
      "required": [
        "title",
        "course",
        "dueDate",
        "fileUrl"
      ]
    },
    "Notification": {
      "title": "Notification",
      "type": "object",
      "description": "An academic notification.",
      "properties": {
        "title": {
          "type": "string"
        },
        "date": {
          "type": "string",
          "format": "date"
        },
        "content": {
          "type": "string"
        }
      },
      "required": [
        "title",
        "date",
        "content"
      ]
    },
    "Attendance": {
      "title": "Attendance",
      "type": "object",
      "description": "Student attendance record for a course.",
      "properties": {
        "studentId": { "type": "string" },
        "course": { "type": "string" },
        "date": { "type": "string", "format": "date" },
        "status": { "type": "string", "enum": ["present", "absent"] }
      },
      "required": ["studentId", "course", "date", "status"]
    },
    "Marks": {
      "title": "Marks",
      "type": "object",
      "description": "Student marks for an exam.",
      "properties": {
        "studentId": { "type": "string" },
        "exam": { "type": "string" },
        "subject": { "type": "string" },
        "marksObtained": { "type": "number" },
        "totalMarks": { "type": "number" }
      },
      "required": ["studentId", "exam", "subject", "marksObtained", "totalMarks"]
    },
    "Activity": {
      "title": "Activity",
      "type": "object",
      "description": "An extra-curricular activity.",
      "properties": {
        "name": { "type": "string" },
        "date": { "type": "string", "format": "date" },
        "description": { "type": "string" }
      },
      "required": ["name", "date", "description"]
    },
    "Timetable": {
      "title": "Timetable",
      "type": "object",
      "description": "A weekly class schedule.",
      "properties": {
        "course": { "type": "string" },
        "branch": { "type": "string" },
        "day": { "type": "string", "enum": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"] },
        "time": { "type": "string" },
        "subject": { "type": "string" }
      },
      "required": ["course", "branch", "day", "time", "subject"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "schema": {
            "$ref": "#/entities/User"
          },
          "description": "Stores user profile information. Path-based ownership ensures only the user can access their data."
        }
      },
      {
        "path": "/courses/{courseId}",
        "definition": {
          "schema": {
            "$ref": "#/entities/Course"
          },
          "description": "Stores course details. Publicly readable."
        }
      },
      {
        "path": "/users/{userId}/progress/{progressId}",
        "definition": {
          "schema": {
            "$ref": "#/entities/Progress"
          },
          "description": "Stores user-specific course progress. Path-based ownership ensures only the user can access their progress data."
        }
      },
      {
        "path": "/students/{studentId}",
        "definition": {
          "schema": {
            "$ref": "#/entities/Student"
          },
          "description": "Stores SAMS student profiles. The studentId must match the Firebase Auth UID, allowing users to read/write their own profile."
        }
      },
      {
        "path": "/assignments/{assignmentId}",
        "definition": {
          "schema": {
            "$ref": "#/entities/Assignment"
          },
          "description": "Stores academic assignments. Readable by all authenticated users, writable by admins (future)."
        }
      },
      {
        "path": "/notifications/{notificationId}",
        "definition": {
          "schema": {
            "$ref": "#/entities/Notification"
          },
          "description": "Stores academic notifications. Readable by all authenticated users."
        }
      },
      {
        "path": "/attendance/{attendanceId}",
        "definition": {
          "schema": {
            "$ref": "#/entities/Attendance"
          },
          "description": "Stores attendance records. Readable by relevant students and staff."
        }
      },
      {
        "path": "/marks/{markId}",
        "definition": {
          "schema": {
            "$ref": "#/entities/Marks"
          },
          "description": "Stores student marks. Readable by the respective student and staff."
        }
      },
      {
        "path": "/activities/{activityId}",
        "definition": {
          "schema": {
            "$ref": "#/entities/Activity"
          },
          "description": "Stores extra-curricular activities. Readable by all authenticated users."
        }
      },
      {
        "path": "/timetable/{timetableId}",
        "definition": {
          "schema": {
            "$ref": "#/entities/Timetable"
          },
          "description": "Stores class timetables. Readable by all authenticated users."
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support a personalized learning experience, prioritizing authorization independence, clarity, and scalability. User data is stored in `/users/{userId}`, ensuring path-based ownership. Courses are stored in a top-level `/courses` collection. User progress is tracked in `/users/{userId}/progress/{progressId}`, maintaining a clear hierarchy for user-specific data. This structure allows for efficient data retrieval and straightforward security rule implementation without relying on complex `get()` calls. Denormalization isn't required as path-based ownership effectively secures user data. Segregation is achieved by separating user-specific data (progress) from global course data, simplifying security postures. QAPs are supported as listing courses doesn't require filtering based on user roles or permissions, as the course data is publicly accessible. SAMS data is stored in separate top-level collections for global access by authorized staff, while student-specific data could be nested under `/students/{studentId}` if needed in the future."
  }
}
